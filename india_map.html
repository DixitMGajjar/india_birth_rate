<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>India State Map Data Visualization</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        

        

        @keyframes blink {
  0%, 100% {
    fill: inherit;
  }
  50% {
    fill: #ff0000;
  }
}

.state.blink {
  animation: blink 1s infinite;
}


        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
            overflow-x: auto;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            min-height: calc(100vh - 40px);
        }

        /* Header Section */
        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title-editor {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 2.5em;
            font-weight: bold;
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            width: 100%;
            backdrop-filter: blur(5px);
        }

        .title-editor::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        /* Control Panel */
        .control-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .control-group {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(5px);
        }

        .control-group h3 {
            margin-bottom: 15px;
            color: #ffeb3b;
        }

        .control-row {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        .control-input {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            backdrop-filter: blur(5px);
        }

        .control-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
        }

        /* Map Section */
        .map-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            position: relative;
            min-height: 800px;
        }

        #map {
            width: 100%;
            height: 100%;
            cursor: grab;
        }

        #map:active {
            cursor: grabbing;
        }

        .state {
            stroke: #2c3e50;
            stroke-width: 1;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .state:hover {
            stroke-width: 2;
            stroke: #34495e;
        }

        .state-label {
            font-weight: bold;
            fill: #2c3e50;
            text-anchor: middle;
            pointer-events: none;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
        }

        .state-value {
            font-weight: bold;
            fill: #e74c3c;
            text-anchor: middle;
            pointer-events: none;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
        }

        /* Zoom Controls */
        .zoom-controls {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .zoom-btn {
            background: rgba(44, 62, 80, 0.9);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            backdrop-filter: blur(5px);
        }

        .zoom-btn:hover {
            background: rgba(52, 73, 94, 0.9);
        }

        /* Legend */
        .legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 10px;
            color: #2c3e50;
            font-size: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
        }

        .color-scale {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .color-bar {
            width: 150px;
            height: 20px;
            border-radius: 10px;
            margin: 0 10px;
        }

        /* Data Table Section */
        .data-section {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            max-height: 800px;
            overflow-y: auto;
        }

        .data-section h3 {
            color: #ffeb3b;
            margin-bottom: 20px;
            text-align: center;
        }

        .table-header {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .header-input {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
            backdrop-filter: blur(5px);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .data-table th {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: bold;
            backdrop-filter: blur(5px);
        }

        .data-table td {
            padding: 8px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .data-table tr:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .state-name {
            text-align: left !important;
            font-weight: 500;
            color: #fff;
        }

        .value-input {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 6px;
            border-radius: 3px;
            width: 80px;
            text-align: center;
            backdrop-filter: blur(5px);
        }

        .value-input:focus {
            outline: 2px solid #ffeb3b;
            background: rgba(255, 255, 255, 0.3);
        }

        /* Status */
        .status {
            text-align: center;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 10px;
            font-weight: bold;
            backdrop-filter: blur(5px);
        }

        .status.loading {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
        }

        .status.ready {
            background: rgba(40, 167, 69, 0.2);
            color: #28a745;
        }

        .status.error {
            background: rgba(220, 53, 69, 0.2);
            color: #dc3545;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .control-panel {
                grid-template-columns: 1fr;
            }
            
            .data-section {
                max-height: 400px;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
                margin: 10px;
            }
            
            .title-editor {
                font-size: 1.8em;
            }
            
            .control-row {
                grid-template-columns: 1fr;
            }
            
            .map-section {
                min-height: 500px;
            }
        }

        /* Tooltip */
        .tooltip {
            position: absolute;
            background: rgba(44, 62, 80, 0.95);
            color: white;
            padding: 10px;
            border-radius: 8px;
            pointer-events: none;
            font-size: 12px;
            z-index: 1000;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <input type="text" class="title-editor" id="mapTitle" 
                   value="ðŸ‡®ðŸ‡³ India State Data Visualization" 
                   placeholder="Enter your map title...">
        </div>

        <!-- Status -->
        <div id="status" class="status loading">Loading India map data...</div>

        <!-- Control Panel -->
        <div class="control-panel">
            <div class="control-group">
                <h3>ðŸŽ¨ Map Styling</h3>
                <div class="control-row">
                    <label>Font Size:</label>
                    <input type="range" class="control-input" id="fontSize" min="8" max="16" value="12">
                </div>
                <div class="control-row">
                    <label>Font Weight:</label>
                    <select class="control-input" id="fontWeight">
                        <option value="normal">Normal</option>
                        <option value="bold" selected>Bold</option>
                        <option value="lighter">Light</option>
                    </select>
                </div>
                <div class="control-row">
                    <label>Color Scheme:</label>
                    <select class="control-input" id="colorScheme">
                        <option value="viridis">Viridis</option>
                        <option value="plasma">Plasma</option>
                        <option value="inferno">Inferno</option>
                        <option value="blues" selected>Blues</option>
                        <option value="reds">Reds</option>
                        <option value="greens">Greens</option>
                    </select>
                </div>
            </div>

            <div class="control-group">
                <h3>ðŸ“Š Data Configuration</h3>
                <div class="control-row">
                    <label>Data Unit:</label>
                    <input type="text" class="control-input" id="dataUnit" 
                           value="%" placeholder="e.g., %, per 1000, millions">
                </div>
                <div class="control-row">
                    <label>Decimal Places:</label>
                    <input type="number" class="control-input" id="decimalPlaces" 
                           min="0" max="3" value="1">
                </div>
                <div class="control-row">
                    <label>Animation Speed:</label>
                    <input type="range" class="control-input" id="animationSpeed" 
                           min="100" max="1000" value="300">
                </div>
            </div>
        </div>

        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Map Section -->
            <div class="map-section">
                <svg id="map"></svg>
                
                <!-- Zoom Controls -->
                <div class="zoom-controls">
                    <button class="zoom-btn" id="zoomIn">+</button>
                    <button class="zoom-btn" id="zoomOut">âˆ’</button>
                    <button class="zoom-btn" id="resetZoom">âŒ‚</button>
                </div>

                <!-- Legend -->
                <div class="legend">
                    <div><strong>Legend</strong></div>
                    <div class="color-scale">
                        <span id="minValue">0</span>
                        <div class="color-bar" id="colorBar"></div>
                        <span id="maxValue">100</span>
                    </div>
                    <div style="margin-top: 10px; font-size: 10px;">
                        <div>â€¢ Click state to highlight</div>
                        <div>â€¢ Use zoom controls or mouse wheel</div>
                        <div>â€¢ Edit values in table to update colors</div>
                    </div>
                </div>
            </div>

            <!-- Data Table Section -->
            <div class="data-section">
                <h3>ðŸ“‹ State Data Editor</h3>
                
                <!-- Table Headers -->
                <div class="table-header">
                    <input type="text" class="header-input" id="stateHeader" value="State/UT">
                    <input type="text" class="header-input" id="valueHeader" value="Value">
                </div>

                <!-- Data Table -->
                <table class="data-table" id="dataTable">
                    <thead>
                        <tr>
                            <th id="tableStateHeader">State/UT</th>
                            <th id="tableValueHeader">Value</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Dynamic content will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Tooltip -->
    <div class="tooltip" id="tooltip" style="display: none;"></div>

    <script>
        // ================================
        // CONFIGURATION SECTION
        // ================================
        /*
"Andaman and Nicobar",
"Apdhra Pradesh",
"Arunachal Pradesh",
"Assam",
"Bihar",
"Chandigarh",
"Chhattisgarh",
"Dadra and Nagar Haveli",
"Daman and Diu",
"Delhi",
"Goa",
"Gujarat",
"Haryana",
"Himachal Pradesh",
"Jammu and Kashmir",
"Jharkhand",
"Karnataka",
"Kerala",
"Lakshadweep",
"Madhya Pradesh",
"Maharashtra",
"Manipur",
"Meghalaya",
"Mizoram",
"Nagaland",
"Orissa",
"Puducherry",
"Punjab",
"Rajasthan",
"Sikkim",
"Tamil Nadu",
"Tripura",
"Uttar Pradesh",
"Uttaranchal",
"West Bengal"
        */
        // ** PLUG IN YOUR DATA HERE **
        // Replace this object with your actual data
        const DEFAULT_DATA = {
            "Andaman and Nicobar": 15.2,
            "Andhra Pradesh": 18.5,
            "Arunachal Pradesh": 22.8,
            "Assam": 24.1,
            "Bihar": 28.6,
            "Chandigarh": 12.1,
            "Chhattisgarh": 25.4,
            "Dadra and Nagar Haveli": 16.8,
            "Daman and Diu":15,
            "Delhi": 14.9,
            "Goa": 13.2,
            "Gujarat": 20.3,
            "Haryana": 19.1,
            "Himachal Pradesh": 16.4,
            "Jammu and Kashmir": 17.6,
            "Jharkhand": 26.2,
            "Karnataka": 19.8,
            "Kerala": 14.1,
            "Ladakh": 18.9,
            "Lakshadweep": 11.5,
            "Madhya Pradesh": 27.3,
            "Maharashtra": 20.2,
            "Manipur": 21.4,
            "Meghalaya": 23.7,
            "Mizoram": 20.9,
            "Nagaland": 22.1,
            "Orissa": 21.8,
            "Puducherry": 15.7,
            "Punjab": 17.2,
            "Rajasthan": 26.1,
            "Sikkim": 15.8,
            "Tamil Nadu": 17.4,
            "Telangana": 19.3,
            "Tripura": 21.6,
            "Uttar Pradesh": 29.2,
            "Uttaranchal": 18.7,
            "West Bengal": 22.4
        };

        // Global variables
        let stateData = { ...DEFAULT_DATA };
        let svg, g, path, projection, zoom;
        let colorScale;
        let isMapLoaded = false;
        let tooltip;

        // ================================
        // INITIALIZATION
        // ================================
        
        document.addEventListener("DOMContentLoaded", function() {
            initializeComponents();
            initializeMap();
        });

        function initializeComponents() {
            tooltip = d3.select("#tooltip");
            setupEventListeners();
            createDataTable();
            updateColorScheme();
        }

        // ================================
        // EVENT LISTENERS
        // ================================
        
        function setupEventListeners() {
            // Title update
            document.getElementById("mapTitle").addEventListener("input", function(e) {
                // You can add any title change logic here
            });

            // Header updates
            document.getElementById("stateHeader").addEventListener("input", function(e) {
                document.getElementById("tableStateHeader").textContent = e.target.value;
            });

            document.getElementById("valueHeader").addEventListener("input", function(e) {
                document.getElementById("tableValueHeader").textContent = e.target.value;
            });

            // Styling controls
            document.getElementById("fontSize").addEventListener("input", updateMapStyling);
            document.getElementById("fontWeight").addEventListener("change", updateMapStyling);
            document.getElementById("colorScheme").addEventListener("change", function() {
                updateColorScheme();
                updateMapColors();
            });

            // Data configuration
            document.getElementById("dataUnit").addEventListener("input", updateDisplay);
            document.getElementById("decimalPlaces").addEventListener("input", function() {
                updateDisplay();
                updateMapColors();
            });

            // Zoom controls
            document.getElementById("zoomIn").addEventListener("click", () => zoomMap(1.5));
            document.getElementById("zoomOut").addEventListener("click", () => zoomMap(0.75));
            document.getElementById("resetZoom").addEventListener("click", resetMapZoom);
        }

        // ================================
        // MAP INITIALIZATION
        // ================================
        
        function initializeMap() {
            const width = 1000;
            const height = 800;

            // Create SVG
            svg = d3.select("#map")
                .attr("width", "100%")
                .attr("height", "100%")
                .attr("viewBox", `0 0 ${width} ${height}`)
                .attr("preserveAspectRatio", "xMidYMid meet");

            // Create zoom behavior
            zoom = d3.zoom()
                .scaleExtent([0.5, 8])
                .on("zoom", function(event) {
                    g.attr("transform", event.transform);
                });

            svg.call(zoom);

            g = svg.append("g");

            // Set up projection for India
            projection = d3.geoMercator()
                .center([78.9629, 20.5937])
                .scale(1000)
                .translate([width/2, height/2]);

            path = d3.geoPath().projection(projection);

            // Load India GeoJSON data
            loadIndiaMap();
        }

        function loadIndiaMap() {
            d3.json("./india-states.geojson")
                .then(loadGeoJSONData)
                .catch(error => {
                    console.error("Primary load failed, trying alternative paths:", error);
                    return d3.json("india-states.geojson");
                })
                .then(loadGeoJSONData)
                .catch(handleError);
        }

        function loadGeoJSONData(geoData) {
            if (!geoData) return;
            
            g.selectAll("*").remove();
            
            // Draw states
            const states = g.selectAll(".state")
                .data(geoData.features)
                .enter()
                .append("path")
                .attr("class", "state")
                .attr("d", path)
                .attr("id", d => getStateId(d))
                .on("mouseover", handleStateMouseOver)
                .on("mousemove", handleStateMouseMove)
                .on("mouseout", handleStateMouseOut)
                .on("click", handleStateClick);

            // Add state labels
            geoData.features.forEach(feature => {
                const centroid = path.centroid(feature);
                const stateName = getStateName(feature);
                
                if (centroid[0] && centroid[1] && !isNaN(centroid[0]) && !isNaN(centroid[1])) {
                    // State name label
                    g.append("text")
                        .attr("class", "state-label")
                        .attr("x", centroid[0])
                        .attr("y", centroid[1] - 5)
                        .text(getDisplayName(stateName));

                    // State value label
                    g.append("text")
                        .attr("class", "state-value")
                        .attr("x", centroid[0])
                        .attr("y", centroid[1] + 10)
                        .attr("id", `value-${getStateId(feature)}`)
                        .text(formatValue(stateData[stateName] || 0));
                }
            });

            updateStatus("ready", "Map loaded successfully! Edit values in the table to update the visualization.");
            isMapLoaded = true;
            updateMapColors();
            updateMapStyling();
        }

        // ================================
        // HELPER FUNCTIONS
        // ================================
        
        function getStateName(feature) {
            return feature.properties.NAME_1 || 
                   feature.properties.name || 
                   feature.properties.NAME || 
                   feature.properties.st_nm || 
                   feature.properties.state_name ||
                   feature.properties.admin_name ||
                   "Unknown State";
        }

        function getStateId(feature) {
            const name = getStateName(feature);
            return name.replace(/\s+/g, '-').replace(/[^a-zA-Z0-9-]/g, '');
        }

        function getDisplayName(stateName) {
            return stateName.length > 12 ? stateName.substring(0, 10) + "..." : stateName;
        }

        function formatValue(value) {
            const decimals = parseInt(document.getElementById("decimalPlaces").value);
            const unit = document.getElementById("dataUnit").value;
            return `${Number(value).toFixed(decimals)}${unit}`;
        }

        // ================================
        // COLOR MANAGEMENT
        // ================================
        
        function updateColorScheme() {
            const scheme = document.getElementById("colorScheme").value;
            const schemes = {
                'viridis': d3.interpolateViridis,
                'plasma': d3.interpolatePlasma,
                'inferno': d3.interpolateInferno,
                'blues': d3.interpolateBlues,
                'reds': d3.interpolateReds,
                'greens': d3.interpolateGreens
            };
            
            const values = Object.values(stateData);
            const minVal = d3.min(values);
            const maxVal = d3.max(values);
            
            colorScale = d3.scaleSequential(schemes[scheme])
                .domain([minVal, maxVal]);
            
            updateColorBar(schemes[scheme], minVal, maxVal);
        }

        function updateColorBar(interpolator, minVal, maxVal) {
            const colorBar = document.getElementById("colorBar");
            const gradient = `linear-gradient(to right, ${
                d3.range(0, 1.1, 0.1).map(t => interpolator(t)).join(', ')
            })`;
            colorBar.style.background = gradient;
            
            document.getElementById("minValue").textContent = formatValue(minVal);
            document.getElementById("maxValue").textContent = formatValue(maxVal);
        }

        function updateMapColors() {
            if (!isMapLoaded) return;
            
            updateColorScheme();
            
            g.selectAll(".state")
                .transition()
                .duration(parseInt(document.getElementById("animationSpeed").value))
                .style("fill", d => {
                    const stateName = getStateName(d);
                    const value = stateData[stateName];
                    return value !== undefined ? colorScale(value) : "#f0f0f0";
                });
        }

        // New function to trigger continuous blink for a specific state
        
        // Function to trigger continuous blink for a specific state
   
// Function to trigger blink for a specific state (improved)
function triggerStateBlink(stateName) {
    if (!isMapLoaded) return;

    const stateElement = g.selectAll(".state")
        .filter(d => getStateName(d) === stateName);

    // Add the blink class
    stateElement.classed("blink", true);

    // Remove the blink class after 2 seconds (2 complete blink cycles)
    setTimeout(() => {
        stateElement.classed("blink", false);
    }, 2000);
}

function stopStateBlink(stateName) {
    if (!isMapLoaded) return;
    
    const stateElement = g.selectAll(".state")
        .filter(d => getStateName(d) === stateName);

    stateElement.classed("blink", false);
}



        function updateMapStyling() {
            if (!isMapLoaded) return;
            
            const fontSize = document.getElementById("fontSize").value;
            const fontWeight = document.getElementById("fontWeight").value;
            
            g.selectAll(".state-label")
                .style("font-size", `${fontSize}px`)
                .style("font-weight", fontWeight);
                
            g.selectAll(".state-value")
                .style("font-size", `${fontSize - 2}px`)
                .style("font-weight", fontWeight);
        }

        // ================================
        // ZOOM FUNCTIONALITY
        // ================================
        
        function zoomMap(factor) {
            svg.transition()
                .duration(300)
                .call(zoom.scaleBy, factor);
        }

        function resetMapZoom() {
            svg.transition()
                .duration(500)
                .call(zoom.transform, d3.zoomIdentity);
        }

        // ================================
        // EVENT HANDLERS
        // ================================
        
        function handleStateMouseOver(event, d) {
            const stateName = getStateName(d);
            const value = stateData[stateName];
            
            d3.select(this)
                .style("stroke-width", "3px")
                .style("stroke", "#2c3e50");
            
            const tooltipContent = `
                <strong>${stateName}</strong><br>
                ${document.getElementById("valueHeader").value}: ${formatValue(value || 0)}
            `;
            
            tooltip.style("display", "block")
                .html(tooltipContent);
        }

        function handleStateMouseMove(event) {
            tooltip.style("left", (event.pageX + 10) + "px")
                .style("top", (event.pageY - 10) + "px");
        }

        function handleStateMouseOut(event, d) {
            d3.select(this)
                .style("stroke-width", "1px")
                .style("stroke", "#2c3e50");
            
            tooltip.style("display", "none");
        }

        function handleStateClick(event, d) {
            const stateName = getStateName(d);
            console.log("State clicked:", stateName);
            
            // Highlight the state briefly
            d3.select(this)
                .transition()
                .duration(200)
                .style("stroke", "#ffeb3b")
                .style("stroke-width", "4px")
                .transition()
                .duration(200)
                .style("stroke", "#2c3e50")
                .style("stroke-width", "1px");
                
            // Scroll to the state in the table
            const tableRow = document.querySelector(`tr[data-state="${stateName}"]`);
            if (tableRow) {
                tableRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
                tableRow.style.background = 'rgba(255, 235, 59, 0.3)';
                setTimeout(() => {
                    tableRow.style.background = '';
                }, 1000);
            }
        }

        // ================================
        // DATA TABLE MANAGEMENT
        // ================================
        
        function createDataTable() {
            const tbody = document.getElementById("tableBody");
            tbody.innerHTML = "";
            
            // Get all Indian states and UTs (comprehensive list)
            const allStatesUTs = [
                                "Andaman and Nicobar",
                "Andhra Pradesh",
                "Arunachal Pradesh",
                "Assam",
                "Bihar",
                "Chandigarh",
                "Chhattisgarh",
                "Dadra and Nagar Haveli",
                "Daman and Diu",
                "Delhi",
                "Goa",
                "Gujarat",
                "Haryana",
                "Himachal Pradesh",
                "Jammu and Kashmir",
                "Jharkhand",
                "Karnataka",
                "Kerala",
                "Lakshadweep",
                "Madhya Pradesh",
                "Maharashtra",
                "Manipur",
                "Meghalaya",
                "Mizoram",
                "Nagaland",
                "Orissa",
                "Puducherry",
                "Punjab",
                "Rajasthan",
                "Sikkim",
                "Tamil Nadu",
                "Tripura",
                "Uttar Pradesh",
                "Uttaranchal",
                "West Bengal"
            ];

            allStatesUTs.forEach(stateName => {
                const value = stateData[stateName] || 0;

                const row = document.createElement("tr");
                row.setAttribute("data-state", stateName);

                const stateCell = document.createElement("td");
                stateCell.classList.add("state-name");
                stateCell.textContent = stateName;

                const valueCell = document.createElement("td");
                const input = document.createElement("input");
                input.type = "number";
                input.classList.add("value-input");
                input.value = value;
                input.addEventListener("change", function(e) {
                    const newVal = parseFloat(e.target.value);
                    stateData[stateName] = isNaN(newVal) ? 0 : newVal;
                    updateMapColors();
                    updateDisplay();
                    // Trigger blink for the specific state
                    triggerStateBlink(stateName);
                });
                
                input.addEventListener("input", function(e) {
                    const newVal = parseFloat(e.target.value);
                    stateData[stateName] = isNaN(newVal) ? 0 : newVal;
                    updateDisplay(); // Real-time value updates
                });

                valueCell.appendChild(input);
                row.appendChild(stateCell);
                row.appendChild(valueCell);
                tbody.appendChild(row);
            });
        }

        function updateDisplay() {
            g.selectAll(".state-value")
                .text(function() {
                    const stateId = this.id.replace('value-', '');
                    // Find the corresponding feature data
                    const allFeatures = g.selectAll(".state").data();
                    for (let feature of allFeatures) {
                        if (getStateId(feature) === stateId) {
                            const stateName = getStateName(feature);
                            const value = stateData[stateName] || 0;
                            return formatValue(value);
                        }
                    }
                    return formatValue(0);
                });
        }

        // ================================
        // STATUS UPDATES
        // ================================
        
        function updateStatus(type, message) {
            const statusEl = document.getElementById("status");
            statusEl.className = "status " + type;
            statusEl.textContent = message;
        }

        function updateStateValue(stateName, value) {
            const valueElement = document.getElementById(`value-${stateName.replace(/\s+/g, '-').replace(/[^a-zA-Z0-9-]/g, '')}`);
            if (valueElement) {
                valueElement.textContent = formatValue(value);
            }
        }

        // ================================
        // ERROR HANDLING
        // ================================
        
        function handleError(error) {
            console.error("Error loading GeoJSON:", error);
            updateStatus("error", "Failed to load india-states.geojson file. This might be due to browser security restrictions. Try serving the files through a local web server (like Live Server in VS Code) or using the file:// protocol may not work for loading JSON files.");
        }

        function updateStatus(type, message) {
            const statusDiv = document.getElementById("status");
            statusDiv.className = `status ${type}`;
            statusDiv.textContent = message;
            
            if (type === "ready") {
                setTimeout(() => {
                    statusDiv.style.display = "none";
                }, 3000);
            }
        }

        // ================================
        // UTILITY FUNCTIONS
        // ================================
        
        // Function to export current data as JSON
        function exportData() {
            const dataStr = JSON.stringify(stateData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'india_state_data.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        // Function to import data from JSON
        function importData(jsonData) {
            try {
                const newData = JSON.parse(jsonData);
                stateData = { ...stateData, ...newData };
                createDataTable();
                updateMapColors();
                updateDisplay();
            } catch (error) {
                console.error("Error importing data:", error);
                alert("Invalid JSON data. Please check your format.");
            }
        }

        // Add keyboard shortcuts
        document.addEventListener("keydown", function(event) {
            // Ctrl+E to export data
            if (event.ctrlKey && event.key === 'e') {
                event.preventDefault();
                exportData();
            }
            
            // Ctrl+R to reset zoom
            if (event.ctrlKey && event.key === 'r') {
                event.preventDefault();
                resetMapZoom();
            }
        });

        // ================================
        // DOCUMENTATION & CUSTOMIZATION GUIDE
        // ================================
        
        /*
        ðŸŽ¯ SKELETON USAGE GUIDE:
        
        1. **DATA CUSTOMIZATION**:
           - Replace DEFAULT_DATA object with your actual data
           - Ensure state names match those in your GeoJSON file
           - Values can be any numeric data (percentages, counts, rates, etc.)
        
        2. **STYLING CUSTOMIZATION**:
           - Color schemes: Update the 'schemes' object in updateColorScheme()
           - Map dimensions: Modify width/height in initializeMap()
           - Fonts: Change font families in CSS or via controls
        
        3. **ADDING NEW FEATURES**:
           - Add new control inputs in the control-panel section
           - Create corresponding event listeners in setupEventListeners()
           - Implement update functions following the existing pattern
        
        4. **DATA SOURCES**:
           - GeoJSON: Place your india-states.geojson in the same directory
           - Alternative: Embed GeoJSON directly in loadGeoJSONData()
           - API Integration: Replace DEFAULT_DATA with API calls
        
        5. **RESPONSIVE BEHAVIOR**:
           - Uses CSS Grid for responsive layout
           - Mobile-friendly controls and touch interactions
           - Scalable SVG for crisp rendering on all devices
        
        6. **KEYBOARD SHORTCUTS**:
           - Ctrl+E: Export current data as JSON
           - Ctrl+R: Reset map zoom to default view
        
        7. **CUSTOMIZATION POINTS**:
           - Line 75-85: Color schemes and interpolators
           - Line 140-180: Default data structure
           - Line 400-450: State name mapping functions
           - Line 600-650: Tooltip content and styling
           - Line 800-850: Table structure and editing behavior
        
        8. **BROWSER COMPATIBILITY**:
           - Requires modern browser with ES6+ support
           - Uses D3.js v7 for data visualization
           - Responsive design works on mobile and desktop
        
        9. **PERFORMANCE NOTES**:
           - Optimized for up to 50 geographic regions
           - Smooth animations with configurable speed
           - Efficient color updates using D3 transitions
        
        10. **EXTENDING THE SKELETON**:
            - Add new data columns by modifying the table structure
            - Implement additional chart types alongside the choropleth
            - Add export functionality for different formats (CSV, PNG, PDF)
            - Integrate with real-time data sources via WebSocket or API polling
        
        ðŸ“Š EXAMPLE CUSTOMIZATIONS:
        
        // For Population Data:
        const POPULATION_DATA = {
            "Maharashtra": 112374333,
            "Uttar Pradesh": 199812341,
            // ... more states
        };
        
        // For Economic Data:
        const GDP_DATA = {
            "Maharashtra": 32.24,  // in trillion rupees
            "Tamil Nadu": 23.65,
            // ... more states  
        };
        
        // For Health/Social Indicators:
        const LITERACY_DATA = {
            "Kerala": 93.91,      // literacy rate %
            "Bihar": 63.82,
            // ... more states
        };
        */

    </script>
</body>
</html>